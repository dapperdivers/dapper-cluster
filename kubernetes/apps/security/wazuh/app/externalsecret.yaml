---
# ExternalSecret to pull Wazuh passwords from Infisical
# These are auto-generated by password-generator.yaml and pushed via pushsecret.yaml
# This ExternalSecret exists so other systems could pull the same credentials if needed
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: wazuh-infisical-sync
  annotations:
    # This is optional - passwords are generated locally
    # Only needed if you want to pull from Infisical as source of truth
    external-secrets.io/optional: "true"
spec:
  refreshInterval: 1h
  secretStoreRef:
    kind: ClusterSecretStore
    name: infisical
  target:
    name: wazuh-passwords-from-infisical
    creationPolicy: Owner
  data:
    - secretKey: WAZUH_INDEXER_PASSWORD
      remoteRef:
        key: WAZUH_INDEXER_PASSWORD
    - secretKey: WAZUH_API_PASSWORD
      remoteRef:
        key: WAZUH_API_PASSWORD
    - secretKey: WAZUH_DASHBOARD_PASSWORD
      remoteRef:
        key: WAZUH_DASHBOARD_PASSWORD
